<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TomTom Routing - Ergebnisse</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.25.0/maps/maps.css"
    />
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>TomTom Routing - Ergebnisse</h1>

    <p><strong>Startort:</strong> {{ start_location }} (Koordinaten: {{ start_coordinates }})</p>
    <p><strong>Zielort:</strong> {{ end_location }} (Koordinaten: {{ end_coordinates }})</p>

    {% if route_data.routes %}
        <h2>Routeninformationen Normal:</h2>
        <ul>
            {% for leg in route_data.routes[0].legs %}
                <li><strong>Entfernung:</strong> {{ leg.summary.lengthInMeters / 1000 }} km</li>
                <li><strong>Dauer:</strong> {{ leg.summary.travelTimeInSeconds / 60 }} Minuten</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Es konnte keine Route gefunden werden.</p>
    {% endif %}
    {% if eco_route_data.routes %}
        <h2>Routeninformationen Eco:</h2>
        <ul>
            {% for leg in eco_route_data.routes[0].legs %}
                <li><strong>Entfernung:</strong> {{ leg.summary.lengthInMeters / 1000 }} km</li>
                <li><strong>Dauer:</strong> {{ leg.summary.travelTimeInSeconds / 60 }} Minuten</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Es konnte keine Route gefunden werden.</p>
    {% endif %}

    <div id="map" class="map"></div>

    {% if geojson_data %}
        <script src="https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.25.0/services/services-web.min.js"></script>
        <script src="https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.25.0/maps/maps-web.min.js"></script>
        <script>
            var geoJson = {{ geojson_data|safe }};
            var ecogeoJson = {{ eco_geojson_data|safe }};

            var map = tt.map({
                key: "1n7hfspttTjYk53H8xAeOcNM53cseplD",
                container: "map",
            });

            map.on('load', function () {
                map.addSource('route-source', {
                    type: 'geojson',
                    data: geoJson
                });

                map.addLayer({
                    id: 'route-layer',
                    type: 'line',
                    source: 'route-source',
                    layout: {
                        'line-join': 'round',
                        'line-cap': 'round'
                    },
                    paint: {
                        'line-color': '#007cbf',
                        'line-width': 6
                    }
                });

                map.addSource('eco-route-source', {
                    type: 'geojson',
                    data: ecogeoJson
                });
                    
                map.addLayer({
                    id: 'eco-route-layer',
                    type: 'line',
                    source: 'eco-route-source',
                    layout: {
                        'line-join': 'round',
                        'line-cap': 'round'
                    },
                    paint: {
                        'line-color': '#00bf89',
                        'line-width': 6
                    }
                });

                var bounds = new tt.LngLatBounds();
                geoJson.features.forEach(function (feature) {
                    bounds.extend(feature.geometry.coordinates);
                });
                map.fitBounds(bounds, { padding: 20 });
            });
        </script>
    {% else %}
        <p>Es konnte keine GeoJSON-Daten gefunden werden.</p>
    {% endif %}

    <p><a href="/">Zur√ºck zur Startseite</a></p>
</body>
</html>
